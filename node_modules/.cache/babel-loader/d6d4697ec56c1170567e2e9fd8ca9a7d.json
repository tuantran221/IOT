{"ast":null,"code":"import _asyncToGenerator from\"/home/tuantran221/Spring2022/software_design/icloud/IOT/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/tuantran221/Spring2022/software_design/icloud/IOT/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/tuantran221/Spring2022/software_design/icloud/IOT/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState}from\"react\";import axios from\"axios\";import Helmet from\"../components/Helmet\";import{Link}from\"react-router-dom\";import config from\"../config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Lognin=function Lognin(props){// React States\nvar _useState=useState({}),_useState2=_slicedToArray(_useState,2),errorMessages=_useState2[0],setErrorMessages=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isSubmitted=_useState4[0],setIsSubmitted=_useState4[1];var errors={uname:\"Password or Email incorrect\"};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _document$forms$,uname,pass,token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://Prevent page reload\nevent.preventDefault();_document$forms$=document.forms[0],uname=_document$forms$.uname,pass=_document$forms$.pass;_context.prev=2;_context.next=5;return axios({method:\"post\",url:config.REACT_APP_SERVER_URL+\"/users/authendication/login\",data:{username:uname.value,password:pass.value}});case 5:token=_context.sent;localStorage.setItem(\"accessToken\",token.data.accessToken);console.log(\"result\",token.data.success);if(token.data.accessToken=true){setIsSubmitted(true);}_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](2);console.log(\"token---\",_context.t0.message);if(_context.t0.message!=null){setErrorMessages({name:\"pass\",message:errors.uname});}case 15:case\"end\":return _context.stop();}}},_callee,null,[[2,11]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();// Generate JSX code for error message\nvar renderErrorMessage=function renderErrorMessage(name){return name===errorMessages.name&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errorMessages.message});};if(isSubmitted===true){props.history.push(\"/Private\");}return/*#__PURE__*/_jsxs(Helmet,{title:\"Private Login\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-container\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"uname\",required:true}),renderErrorMessage(\"uname\")]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-container\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password \"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"pass\",required:true}),renderErrorMessage(\"pass\")]}),/*#__PURE__*/_jsx(\"div\",{className:\"button-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"submit\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"linkto\",children:/*#__PURE__*/_jsx(Link,{to:\"/SignUp\",children:\"you don't have an account? \"})})]});};export default Lognin;","map":{"version":3,"sources":["/home/tuantran221/Spring2022/software_design/icloud/IOT/frontend/src/pages/Login.jsx"],"names":["React","useState","axios","Helmet","Link","config","Lognin","props","errorMessages","setErrorMessages","isSubmitted","setIsSubmitted","errors","uname","handleSubmit","event","preventDefault","document","forms","pass","method","url","REACT_APP_SERVER_URL","data","username","value","password","token","localStorage","setItem","accessToken","console","log","success","message","name","renderErrorMessage","history","push"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport axios from \"axios\";\nimport Helmet from \"../components/Helmet\";\nimport { Link } from \"react-router-dom\";\nimport config from \"../config\"\nconst Lognin = (props) => {\n  // React States\n  const [errorMessages, setErrorMessages] = useState({});\n  const [isSubmitted, setIsSubmitted] = useState(false);\n\n  const errors = {\n    uname: \"Password or Email incorrect\",\n  };\n\n  const handleSubmit = async (event) => {\n    //Prevent page reload\n    event.preventDefault();\n    var { uname, pass } = document.forms[0];\n\n    try {\n      let token = await axios({\n        method: \"post\",\n        url: config.REACT_APP_SERVER_URL+\"/users/authendication/login\",\n        data: { username: uname.value, password: pass.value },\n      });\n\n      localStorage.setItem(\"accessToken\", token.data.accessToken);\n      console.log(\"result\", token.data.success);\n      if ((token.data.accessToken = true)) {\n        setIsSubmitted(true);\n      }\n    } catch (err) {\n      console.log(\"token---\", err.message);\n\n      if (err.message != null) {\n        setErrorMessages({ name: \"pass\", message: errors.uname });\n      }\n    }\n  };\n\n  // Generate JSX code for error message\n  const renderErrorMessage = (name) =>\n    name === errorMessages.name && (\n      <div className=\"error\">{errorMessages.message}</div>\n    );\n  if (isSubmitted === true) {\n    props.history.push(\"/Private\");\n  }\n\n  return (\n    <Helmet title=\"Private Login\">\n      <div className=\"form\">\n        <form onSubmit={handleSubmit}>\n          <div className=\"input-container\">\n            <label>Email </label>\n            <input type=\"text\" name=\"uname\" required />\n            {renderErrorMessage(\"uname\")}\n          </div>\n          <div className=\"input-container\">\n            <label>Password </label>\n            <input type=\"password\" name=\"pass\" required />\n            {renderErrorMessage(\"pass\")}\n          </div>\n          <div className=\"button-container\">\n            <input type=\"submit\" />\n          </div>\n        </form>\n      </div>\n\n      <div className=\"linkto\">\n        <Link to=\"/SignUp\">you don't have an account? </Link>\n      </div>\n    </Helmet>\n  );\n};\nexport default Lognin;\n"]},"metadata":{},"sourceType":"module"}